# OpenSSL Configuration for Root CA
# Assignment 2 - PKI Infrastructure

[ ca ]
default_ca = CA_default

[ CA_default ]
# Diretório base da Root CA (relativo à localização deste ficheiro)
dir = .

# Ficheiros da CA
certs = $dir/certs
crl_dir = $dir/crl
new_certs_dir = $dir/newcerts
database = $dir/index.txt
serial = $dir/serial
RANDFILE = $dir/private/.rand

# Chave privada e certificado da Root CA
private_key = $dir/private/root-ca.key
certificate = $dir/certs/root-ca.crt

# Política de certificação
policy = policy_strict

# Extensões para certificados CA
x509_extensions = v3_ca

# Comandos padrão
default_days = 3650    # 10 anos para Root CA
default_crl_days = 30  # CRL válido por 30 dias
default_md = sha256    # SHA-256 conforme Assignment 1

# Manter extensões do certificado
copy_extensions = copy

# Mensagens
preserve = no

[ policy_strict ]
# Política estrita para Root CA - apenas assina Intermediate CA
countryName = match
stateOrProvinceName = optional
localityName = optional
organizationName = match
organizationalUnitName = optional
commonName = supplied
emailAddress = optional

[ policy_loose ]
# Política mais flexível (não usada na Root CA, mas definida para referência)
countryName = optional
stateOrProvinceName = optional
localityName = optional
organizationName = optional
organizationalUnitName = optional
commonName = supplied
emailAddress = optional

[ req ]
# Configurações para gerar Certificate Signing Requests
default_bits = 4096
prompt = no
default_md = sha256
distinguished_name = req_distinguished_name
string_mask = utf8only

[ req_distinguished_name ]
# Informações do Root CA
countryName = PT
stateOrProvinceName = Portugal
localityName = Coimbra
organizationName = Assignment 2 PKI
organizationalUnitName = Root CA
commonName = Root CA - Assignment 2

[ v3_ca ]
# Extensões para certificados CA
subjectKeyIdentifier = hash
authorityKeyIdentifier = keyid:always,issuer
basicConstraints = critical, CA:true, pathlen:1
keyUsage = critical, digitalSignature, cRLSign, keyCertSign

# CRL Distribution Points
crlDistributionPoints = URI:file://../root-ca/crl/root-ca.crl.pem

# Authority Information Access
authorityInfoAccess = OCSP;URI:http://ca01.org.local/ocsp

[ v3_intermediate_ca ]
# Extensões para certificar Intermediate CA
subjectKeyIdentifier = hash
authorityKeyIdentifier = keyid:always,issuer
basicConstraints = critical, CA:true, pathlen:0
keyUsage = critical, digitalSignature, cRLSign, keyCertSign

# CRL Distribution Points
crlDistributionPoints = URI:file://../intermediate-ca/crl/intermediate-ca.crl.pem

# Authority Information Access
authorityInfoAccess = OCSP;URI:http://ca01.org.local/ocsp
